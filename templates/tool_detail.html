{% extends "base.html" %}
{% block title %}{{ tool.name }} • Detail{% endblock %}
{% block content %}
<a href="{% url 'dashboard' %}" class="btn btn-sm btn-outline-light mb-3">← Späť na zoznam</a>

<div class="card bg-dark border-secondary mb-4">
  <div class="card-body">
    <h3 class="card-title mb-3">{{ tool.name }} <small class="text-muted">({{ tool.serial_number }})</small></h3>
    <div class="row">
      <div class="col-md-6">
        <p><strong>Typ:</strong> {{ tool.tool_type }}</p>
        <p><strong>Kategória:</strong> {{ tool.category }}</p>
        <p><strong>Pobočka:</strong> {{ tool.branch.name|default:"—" }}</p>
        <p><strong>Stav:</strong>
          {% with code=tool.status label=tool.get_status_display %}
            {% if code == "sklad" %}<span class="badge bg-success">{{ label }}</span>
            {% elif code == "vydane" %}<span class="badge bg-warning text-dark">{{ label }}</span>
            {% elif code == "poskodene" %}<span class="badge bg-danger">{{ label }}</span>
            {% elif code == "v_servise" or code == "cakajuci_servis" %}<span class="badge bg-info text-dark">{{ label }}</span>
            {% elif code == "vyradene" or code == "stratene" %}<span class="badge bg-secondary">{{ label }}</span>
            {% else %}<span class="badge bg-light text-dark">{{ label }}</span>{% endif %}
          {% endwith %}
        </p>
      </div>
      <div class="col-md-6">
        <p><strong>Dátum zakúpenia:</strong> {{ tool.purchase_date|date:"d.m.Y" }}</p>
        <p><strong>Záruka do:</strong> {{ tool.warranty_until|date:"d.m.Y" }}</p>
        <p><strong>Dátum výdaja:</strong> {{ tool.issue_date|date:"d.m.Y"|default:"—" }}</p>
        <p><strong>Dátum príjmu:</strong> {{ tool.return_date|date:"d.m.Y"|default:"—" }}</p>
      </div>
    </div>
    <p class="mt-3"><strong>Poznámky:</strong><br>{{ tool.notes|linebreaks|default:"—" }}</p>
  </div>
</div>

<h4 class="mb-2">Servisné záznamy ({{ services.count }})</h4>
<div class="table-responsive">
  <table class="table table-dark table-striped table-hover table-sm">
    <thead>
      <tr>
        <th>Dátum</th>
        <th>Popis</th>
      </tr>
    </thead>
    <tbody>
      {% for s in services %}
      <tr>
        <td>{{ s.service_date|date:"d.m.Y" }}</td>
        <td>{{ s.description }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="2" class="text-muted">Žiadne servisné záznamy.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
